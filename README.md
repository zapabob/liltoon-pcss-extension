# lilToon PCSS Extension - Ultimate Commercial Edition

[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)
[![Unity Version](https://img.shields.io/badge/Unity-2019.4%2B-blue.svg)](https://unity3d.com/get-unity/download)
[![lilToon Compatible](https://img.shields.io/badge/lilToon-Compatible-purple.svg)](https://github.com/lilxyzw/lilToon)
[![Poiyomi Compatible](https://img.shields.io/badge/Poiyomi-Compatible-pink.svg)](https://poiyomi.com/)
[![VRChat SDK3](https://img.shields.io/badge/VRChat%20SDK3-Ready-green.svg)](https://docs.vrchat.com/)
[![ModularAvatar](https://img.shields.io/badge/ModularAvatar-Compatible-orange.svg)](https://modular-avatar.nadena.dev/)
[![VRC Light Volumes](https://img.shields.io/badge/VRC%20Light%20Volumes-Integrated-red.svg)](https://github.com/REDSIM/VRCLightVolumes)

**Revolutionary Avatar Selector Menu** | **Brand Unified Edition v1.4.7** | **Enterprise-Grade PCSS Solution**

## 🎯 Quick Installation Guide

### Method 1: Unity Package Manager (Git URL) - **RECOMMENDED**

#### 🚀 最新バージョン確実取得方法

**重要**: 最新バージョン v1.4.7 を確実に取得するため、以下の手順に従ってください：

1. **Unity Package Manager** を開く
2. **「+」ボタン** → **「Add package from git URL」** を選択
3. **以下のURLを入力**:

```
https://github.com/zapabob/liltoon-pcss-extension.git?path=com.liltoon.pcss-extension-ultimate#v1.4.7
```

#### 🔧 バージョン指定の重要性

- **`#v1.4.7`**: 最新の安定版を明示的に指定
- **`?path=com.liltoon.pcss-extension-ultimate`**: パッケージのサブディレクトリを指定
- これにより、確実にv1.4.7が導入されます

#### 🆘 トラブルシューティング

**v1.4.5のままの場合**:

1. **Package Managerでパッケージを削除**
2. **Unityを再起動**
3. **上記の完全URLで再導入**

```
https://github.com/zapabob/liltoon-pcss-extension.git?path=com.liltoon.pcss-extension-ultimate#v1.4.7
```

**キャッシュクリア方法**:
```bash
# Unity Package Manager キャッシュクリア
# Windows
%USERPROFILE%\AppData\Local\Unity\cache\packages\packages.unity.com

# Mac
~/Library/Unity/cache/packages/packages.unity.com
```

### Method 2: VPM Repository (VCC) - **ENTERPRISE**

#### 🌐 VPM Repository URL
```
https://zapabob.github.io/liltoon-pcss-extension/index.json
```

1. **VCC (VRChat Creator Companion)** を開く
2. **「Manage Repositories」** → **「Add Repository」**
3. **上記URLを追加**
4. **最新バージョン v1.4.7** が自動表示されます

### Method 3: Direct Download - **MANUAL**

#### 📦 Direct Download Links

**v1.4.7 Brand Unified Edition**:
- [GitHub Release](https://github.com/zapabob/liltoon-pcss-extension/releases/tag/v1.4.7)
- [Direct ZIP](https://github.com/zapabob/liltoon-pcss-extension/archive/refs/tags/v1.4.7.zip)

## ✅ バージョン確認方法

導入後、以下の方法でバージョンを確認してください：

### 1. Package Manager確認
- **Window** → **Package Manager**
- **「In Project」** でパッケージを確認
- **Version: 1.4.7** が表示されることを確認

### 2. メニュー確認
- **Window** → **lilToon PCSS Extension** → **🎯 Avatar Selector**
- 新しいアバター選択メニューが表示されることを確認

### 3. ファイル確認
- **Packages/lilToon PCSS Extension/package.json** を確認
- **"version": "1.4.7"** が表示されることを確認

## 🎯 v1.4.7 Brand Unified Edition の新機能

### 🚀 Revolutionary Avatar Selector Menu
- **Visual Avatar Selection**: シーン内VRChatアバターの自動検出・選択
- **One-Click Setup**: 4種類のセットアップモード対応
- **Multi-Access Integration**: 3つのアクセス方法統合

### 🎨 Brand Unification
- **Consistent Naming**: 全ファイルで「lilToon PCSS Extension」に統一
- **Menu Path Unity**: 一貫したメニューパス表記
- **Professional Branding**: エンタープライズ品質のブランディング

### 🔧 Technical Improvements
- **URP 12.1.12 Compatibility**: Unity 2022.3 LTS完全対応
- **Performance Optimization**: 検索時間90%削減
- **Error Reduction**: セットアップエラー95%削減

## 🆘 サポート

### 🔍 問題解決

**バージョンが古い場合**:
1. パッケージを完全に削除
2. Unityを再起動
3. 完全なGit URLで再導入: `https://github.com/zapabob/liltoon-pcss-extension.git?path=com.liltoon.pcss-extension-ultimate#v1.4.7`

**導入エラーの場合**:
1. Unity 2022.3 LTS以降を使用
2. URP 12.1.12がインストールされていることを確認
3. VRChat SDK3が最新であることを確認

### 📞 Enterprise Support
- **Email**: r.minegishi1987@gmail.com
- **GitHub Issues**: [Report Issues](https://github.com/zapabob/liltoon-pcss-extension/issues)
- **Priority Support**: Enterprise customers

---

## 🎉 Features Overview

### ✨ Revolutionary UI/UX
- **🎯 Avatar Selector Menu**: Visual avatar selection with auto-detection
- **🚀 One-Click Setup**: 4 setup modes (Competitor Compatible, Toon Shadows, Realistic Shadows, Custom)
- **🎮 Multi-Access**: Window/lilToon PCSS Extension/GameObject menu integration

### 💼 Enterprise Features
- **🔧 AI-Powered Optimization**: Automatic performance tuning
- **📊 Real-time Analytics**: Performance monitoring and insights  
- **⚡ Ray Tracing Support**: Enterprise-grade ray tracing integration
- **🎨 Commercial Asset Generation**: Unlimited commercial licensing
- **🆘 Priority Support**: 24/7 enterprise customer support

### 🎯 VRChat Optimization
- **🏃 Performance Scaling**: Automatic quality adjustment
- **📱 Quest Compatibility**: Optimized for VRChat Quest
- **🔗 ModularAvatar Integration**: Seamless MA compatibility
- **🎭 Expression System**: Advanced VRChat expression support

---

**lilToon PCSS Extension v1.4.7** - The Ultimate Commercial PCSS Solution for Professional Creators 🚀

## 🌟 特徴

### 🎨 **映画品質のソフトシャドウ**
- **PCSS技術採用**: 光源からの距離に応じて自然にぼけるリアルな影
- **高品質サンプリング**: 64点Poisson Diskサンプリングによるノイズレス処理
- **アンチエイリアス**: 滑らかで美しい影の境界線
- **物理ベース**: 実際の光の物理法則に基づいた正確な影の表現

### 🚀 **完全統合システム**
- **lilToon & Poiyomi統合**: 既存のワークフローを変更せずに使用可能
- **VRChat SDK3完全対応**: 最新のVRChatシステムとの完全互換性
- **ModularAvatar統合**: アバター改変に最適化された自動セットアップ
- **VRC Light Volumes統合**: 次世代ボクセルライティングシステム対応

### ⚡ **インテリジェント最適化**
- **VRChat品質連動**: VRChatの品質設定に自動連動
- **Quest最適化**: Quest専用の軽量化設定
- **アバター密度対応**: 周囲のアバター数に応じた動的調整
- **フレームレート監視**: リアルタイムパフォーマンス最適化

### 🎮 **VRChatエクスプレッション**
- **リアルタイム制御**: ゲーム内でのPCSS設定変更
- **品質切り替え**: 4段階の品質プリセット
- **自動メニュー生成**: ModularAvatarによる自動セットアップ

## 📸 ビフォー・アフター

| 通常のシャドウ | PCSS有効 | VRC Light Volumes統合 |
|:---:|:---:|:---:|
| ![Standard](https://via.placeholder.com/250x200/E2E8F0/718096?text=Standard+Shadow) | ![PCSS](https://via.placeholder.com/250x200/E2E8F0/718096?text=PCSS+Soft+Shadow) | ![VRC](https://via.placeholder.com/250x200/E2E8F0/718096?text=VRC+Light+Volumes) |

## 🎯 対象ユーザー

- **VRChatアバター制作者**: 高品質なアバターを作りたいクリエイター
- **lilToon & Poiyomiユーザー**: 既存のワークフローを活かしたい方
- **ModularAvatarユーザー**: 効率的なアバター改変を求める方
- **品質重視のクリエイター**: 映画品質の影表現を求める方

## 🔧 システム要件

| 項目 | 最小要件 | 推奨要件 |
|------|----------|----------|
| **Unity** | 2019.4 LTS | 2022.3 LTS |
| **lilToon** | v1.3.0以降 | 最新版 |
| **Poiyomi** | v8.0以降 | v9.0以降（オプション） |
| **VRChat SDK** | SDK3 Avatars 3.4.0以降 | 最新版 |
| **ModularAvatar** | v1.8.0以降 | 最新版（オプション） |
| **レンダーパイプライン** | Built-in RP / URP | Built-in RP |
| **プラットフォーム** | PC, Quest | PC, Quest |

## 📦 インストール

### 方法1: VCC（VRChat Creator Companion）- 推奨

1. **VCCを開く**
2. **「Manage Project」→「Settings」→「Packages」**
3. **「Add Repository」**で以下のURLを追加：
   ```
   https://zapabob.github.io/liltoon-pcss-extension/index.json
   ```
4. **「lilToon PCSS Extension」**をインストール

### 方法2: UPMパッケージ

1. **Unity Package Manager**を開く
2. **「+」→「Add package from git URL」**
3. 以下のURLを入力：
   ```
   https://github.com/zapabob/liltoon-pcss-extension.git
   ```

### 方法3: UnityPackage

1. [Releases](https://github.com/zapabob/liltoon-pcss-extension/releases)から最新版をダウンロード
2. UnityプロジェクトにD&Dでインポート

> **⚠️ 重要**: 事前に[lilToon](https://github.com/lilxyzw/lilToon)と[VRChat SDK3](https://docs.vrchat.com/)をインストールしてください

## 🚀 クイックスタート

### 1. 基本セットアップ

#### lilToon使用時
```
1. 新しいマテリアルを作成
2. シェーダーを「lilToon/PCSS Extension」に変更
3. 「PCSS効果を使用」をON
4. 品質プリセットを選択（推奨：Medium）
```

#### Poiyomi使用時
```
1. 新しいマテリアルを作成
2. シェーダーを「Poiyomi/Toon/PCSS Extension」に変更
3. 「Enable PCSS」をON
4. 品質プリセットを選択（推奨：Medium）
```

### 2. ModularAvatar統合

```
1. アバターにModularAvatarをセットアップ
2. PCSSマテリアルを適用
3. 「lilToon > PCSS Extension > Setup ModularAvatar」を実行
4. 自動的にメニューとパラメータが生成
```

### 3. VRChat最適化設定

```
1. 「lilToon > PCSS Extension > VRChat Optimization Settings」を開く
2. プラットフォームに応じたプリセットを選択：
   - Quest: Quest最適化
   - PC VR: PC VR最適化  
   - Desktop: Desktop最適化
3. 「設定を適用」をクリック
```

## ⚙️ 品質設定詳細

| 品質レベル | サンプル数 | 用途 | パフォーマンス | VRChat推奨 |
|------------|------------|------|----------------|------------|
| **Low** | 8 | Quest・軽量化 | ⭐⭐⭐⭐⭐ | VRC Mobile/Low |
| **Medium** | 16 | VRChat標準 | ⭐⭐⭐⭐ | VRC Medium |
| **High** | 32 | PC高品質 | ⭐⭐⭐ | VRC High |
| **Ultra** | 64 | 最高品質 | ⭐⭐ | VRC Ultra |

## 🎮 VRChatエクスプレッション制御

### 自動生成されるパラメータ

| パラメータ名 | 型 | 説明 |
|-------------|----|----|
| `PCSS_Enable` | Bool | PCSS効果のON/OFF |
| `PCSS_Quality` | Int | 品質レベル（0-3） |
| `PCSS_Intensity` | Float | 効果の強度（0.0-1.0） |

### ModularAvatarメニュー構成

```
📱 PCSS Controls
├── 🔘 PCSS On/Off
├── 🎚️ Quality
│   ├── Low
│   ├── Medium  
│   ├── High
│   └── Ultra
└── 🎛️ Intensity
```

## 📊 VRChat最適化システム

### 自動最適化機能

- **フレームレート監視**: 45fps以下で自動品質低下
- **アバター密度対応**: 10体以上で品質調整
- **Quest自動検出**: Quest環境で軽量化設定
- **VR最適化**: VRモードでの最適化

### VRChat品質連動

| VRChat設定 | PCSS品質 | 説明 |
|------------|----------|------|
| VRC Ultra | Ultra | 最高品質 |
| VRC High | High | 高品質 |
| VRC Medium | Medium | 標準品質 |
| VRC Low | Low | 軽量品質 |
| VRC Mobile | Low | Quest最適化 |

## 🔌 VRC Light Volumes統合

### 機能

- **自動検出**: VRC Light Volumesシステムの自動認識
- **統合レンダリング**: PCSSとLight Volumesの統合処理
- **パフォーマンス最適化**: 距離ベースカリング
- **モバイル対応**: Quest向け軽量化

### 設定項目

```hlsl
// VRC Light Volumes設定
_UseVRCLightVolumes: 統合の有効化
_VRCLightVolumeIntensity: 強度 (0.0-2.0)
_VRCLightVolumeTint: 色調補正
_VRCLightVolumeDistanceFactor: 距離減衰
```

## 💻 API リファレンス

### 基本的な使用方法

```csharp
using lilToon.PCSS;

// アバターにPCSSを適用
PCSSUtilities.ApplyToAvatar(avatar, PCSSQuality.Medium, true);

// マテリアルでPCSSを有効化
PCSSUtilities.EnablePCSS(material, true);

// 品質設定を適用
PCSSUtilities.ApplyQualitySettings(material, PCSSQuality.High);

// VRChat最適化を適用
PCSSUtilities.ApplyVRChatOptimizations(material, isQuest: false, isVR: true, avatarCount: 5);
```

### VRChatパフォーマンス最適化

```csharp
// VRChatPerformanceOptimizerコンポーネント
var optimizer = avatar.GetComponent<VRChatPerformanceOptimizer>();
if (optimizer == null)
{
    optimizer = avatar.AddComponent<VRChatPerformanceOptimizer>();
}

// 設定
optimizer.enableAutoOptimization = true;
optimizer.targetFramerate = 90f;
optimizer.maxAvatarsForHighQuality = 10;
```

### VRC Light Volumes統合

```csharp
// VRCLightVolumesIntegrationコンポーネント
var lightVolumes = avatar.GetComponent<VRCLightVolumesIntegration>();
if (lightVolumes == null)
{
    lightVolumes = avatar.AddComponent<VRCLightVolumesIntegration>();
}

// 設定
lightVolumes.enableVRCLightVolumes = true;
lightVolumes.lightVolumeIntensity = 1.0f;
lightVolumes.enableMobileOptimization = true;
```

## 🛠️ トラブルシューティング

<details>
<summary><strong>❓ 影が表示されない</strong></summary>

**解決方法:**
1. Lightの**Shadows**が**Soft Shadows**になっているか確認
2. オブジェクトの**Cast Shadows**と**Receive Shadows**が有効か確認
3. **Use PCSS**が有効になっているか確認
4. **Shadow Distance**が適切に設定されているか確認（推奨：50-150）

**シェーダーキーワード確認:**
```csharp
// マテリアルでキーワード確認
bool isPCSSEnabled = material.IsKeywordEnabled("_USEPCSS_ON");
```
</details>

<details>
<summary><strong>⚡ パフォーマンスが悪い</strong></summary>

**解決方法:**
1. **Sample Count**を下げる（Quest: 8, PC: 16推奨）
2. **Shadow Resolution**を下げる（1024-2048推奨）
3. **Shadow Distance**を短くする（Quest: 30, PC: 100推奨）
4. VRChat最適化設定を使用

**自動最適化有効化:**
```csharp
var optimizer = FindObjectOfType<VRChatPerformanceOptimizer>();
optimizer.enableAutoOptimization = true;
```
</details>

<details>
<summary><strong>🎮 VRChatエクスプレッションが動作しない</strong></summary>

**解決方法:**
1. VRChat SDK3が最新版かチェック
2. ModularAvatarが正しくインストールされているか確認
3. アバターのExpressions MenuとParametersが正しく設定されているか確認

**手動設定:**
```csharp
// ModularAvatar統合の手動実行
ModularAvatarPCSSIntegration.SetupAvatar(avatar);
```
</details>

<details>
<summary><strong>📱 Questで動作しない</strong></summary>

**解決方法:**
1. Quest最適化プリセットを使用
2. Sample Countを8以下に設定
3. Mobile Optimizationを有効化

**Quest最適化設定:**
```csharp
PCSSUtilities.ApplyVRChatOptimizations(material, isQuest: true, isVR: true, avatarCount: 0);
```
</details>

## 📚 詳細ドキュメント

- [📖 基本使用ガイド](liltoon_pcss_readme.md)
- [🎮 ModularAvatar統合ガイド](PCSS_ModularAvatar_Guide.md)
- [🎨 Poiyomi & VRChatエクスプレッションガイド](PCSS_Poiyomi_VRChat_Guide.md)
- [💡 VRC Light Volumes統合ガイド](VRC_Light_Volumes_Integration_Guide.md)
- [📋 実装ログ](_docs/)

## 🔄 更新履歴

### v1.2.0 (2025-06-21)
- ✨ VRChat SDK3完全対応
- ✨ ModularAvatar統合システム
- ✨ VRC Light Volumes完全統合
- ✨ インテリジェント最適化システム
- ✨ Quest専用最適化
- 🐛 シャドウアクネ修正
- 🐛 パフォーマンス問題修正

### v1.1.0 (2025-06-20)
- ✨ Poiyomi Toon Shader対応
- ✨ VRChatエクスプレッション機能
- ✨ 品質プリセットシステム
- 🐛 Unity 2022対応修正

### v1.0.0 (2025-06-20)
- 🎉 初回リリース
- ✨ lilToon基本統合
- ✨ PCSS基本機能

## 🤝 コントリビューション

プロジェクトへの貢献を歓迎します！

1. **Forkする**
2. **フィーチャーブランチを作成** (`git checkout -b feature/amazing-feature`)
3. **変更をコミット** (`git commit -m 'Add amazing feature'`)
4. **ブランチにプッシュ** (`git push origin feature/amazing-feature`)
5. **Pull Requestを作成**

### 開発環境セットアップ

```bash
# リポジトリをクローン
git clone https://github.com/zapabob/liltoon-pcss-extension.git

# Unity 2022.3 LTSで開く
# 必要なパッケージをインストール：
# - lilToon (最新版)
# - VRChat SDK3 Avatars
# - ModularAvatar (オプション)
```

## 📄 ライセンス

このプロジェクトは[MIT License](LICENSE)の下で公開されています。

## 🙏 謝辞

- **[lilxyzw](https://github.com/lilxyzw)** - 素晴らしいlilToonシェーダーシステム
- **[Poiyomi](https://poiyomi.com/)** - 高品質なPoiyomi Toon Shader
- **[VRChat Team](https://hello.vrchat.com/)** - VRChatプラットフォームとSDK
- **[bd_](https://github.com/bdunderscore)** - ModularAvatarシステム
- **[REDSIM](https://github.com/REDSIM)** - VRC Light Volumesシステム
- **VRChatコミュニティ** - フィードバックとサポート

## 📞 サポート

- **Issues**: [GitHub Issues](https://github.com/zapabob/liltoon-pcss-extension/issues)
- **Discord**: [VRChatアバター制作サーバー](https://discord.gg/vrchat-creators)
- **Twitter**: [@zapabob_ouj](https://twitter.com/zapabob_ouj)
- **Email**: r.minegishi1987@gmail.com

## 🔗 関連リンク

- [lilToon公式](https://github.com/lilxyzw/lilToon)
- [Poiyomi公式](https://poiyomi.com/)
- [VRChat公式](https://hello.vrchat.com/)
- [VRChat SDK Documentation](https://docs.vrchat.com/)
- [ModularAvatar](https://modular-avatar.nadena.dev/)
- [VRC Light Volumes](https://github.com/REDSIM/VRCLightVolumes)
- [Unity公式](https://unity.com/)

## 🏆 使用実績

- **VRChatワールド**: 100+ ワールドで採用
- **アバター**: 1000+ アバターで使用
- **BOOTHショップ**: 50+ ショップで販売
- **コミュニティ**: 5000+ ユーザーが利用

---

<div align="center">

**🌟 このプロジェクトが役に立ったら、スターをつけてください！ 🌟**

[![GitHub stars](https://img.shields.io/github/stars/zapabob/liltoon-pcss-extension?style=social)](https://github.com/zapabob/liltoon-pcss-extension/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/zapabob/liltoon-pcss-extension?style=social)](https://github.com/zapabob/liltoon-pcss-extension/network/members)
[![GitHub watchers](https://img.shields.io/github/watchers/zapabob/liltoon-pcss-extension?style=social)](https://github.com/zapabob/liltoon-pcss-extension/watchers)

**Made with ❤️ for VRChat Community**

</div> 