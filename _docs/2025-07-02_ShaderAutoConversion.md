# 実装ログ: シェーダー自動変換機能

## 概要

FBX/モデルインポート時に、VRChatに適さないシェーダー（例: Standard, URP Lit）が割り当てられているマテリアルを、自動的にlilToonまたはlilToon PCSS Extensionシェーダーに変換する機能を実装しました。これにより、マテリアルがMissingになる問題の一因であるシェーダーの不一致を解消し、VRChatアバター制作のワークフローを改善します。

## 実施内容

1.  **`ShaderAutoConverter.cs` の新規作成:**
    - `Assets/Editor/ShaderAutoConverter.cs` に新しいスクリプトを作成しました。
    - このスクリプトは `AssetPostprocessor` を継承し、モデルインポート後の処理 (`OnPostprocessModel`) をフックします。

2.  **シェーダー変換ロジック:**
    - インポートされたモデル内のすべてのマテリアルを走査します。
    - マテリアルが「Standard」または「Universal Render Pipeline/Lit」シェーダーを使用している場合、変換対象と判断します。
    - プロジェクト内に「lilToon」または「lilToon/lilToon_PCSS」シェーダーが存在するかを `Shader.Find()` で検索し、優先順位（PCSS Extension -> lilToon）に基づいて新しいシェーダーを決定します。
    - 新しいシェーダーが見つかった場合、ユーザーに確認ダイアログを表示し、同意を得てからシェーダーを変換します。
    - 変換後、元のシェーダーの基本的なプロパティ（`_Color`, `_MainTex`）を新しいシェーダーにコピーします。

3.  **ユーザーエクスペリエンスの向上:**
    - 自動変換前にユーザーの確認を求めることで、意図しない変更を防ぎ、ユーザーの制御を維持します。
    - シェーダーの不一致によるマテリアルのピンク化（Missing）問題を自動的に解決し、アバター制作の手間を削減します。

## 今後の展望

- より多くのシェーダータイプへの対応。
- 詳細なプロパティマッピングの強化。
- 変換対象シェーダーのカスタマイズオプションの追加。
